{% load static %}

<!doctype html>
<html class="no-js" lang="en">

    <head>
        <!-- meta data -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

        <!--font-family-->
		<link href="https://fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
        
        <!-- title of site -->
        <title>Geostats</title>

        <!-- For favicon png -->
		<link rel="shortcut icon" type="image/icon" href="{% static '/logo/favicon.png' %}"/>
       
        <!--font-awesome.min.css-->
        <link rel="stylesheet" href="{% static '/css/font-awesome.min.css' %}">

        <!--linear icon css-->
		<link rel="stylesheet" href="{% static '/css/linearicons.css' %}">

		<!--animate.css-->
        <link rel="stylesheet" href="{% static '/css/animate.css' %}">

		<!--flaticon.css-->
        <link rel="stylesheet" href="{% static '/css/flaticon.css' %}">

		<!--slick.css-->
        <link rel="stylesheet" href="{% static '/css/slick.css' %}">
		<link rel="stylesheet" href="{% static '/css/slick-theme.css' %}">
		
        <!--bootstrap.min.css-->
        <link rel="stylesheet" href="{% static '/css/bootstrap.min.css' %}">
		
		<!-- bootsnav -->
		<link rel="stylesheet" href="{% static '/css/bootsnav.css' %}" >	
        
        <!--style.css-->
        <link rel="stylesheet" href="{% static '/css/style.css' %}">
        
        <!--responsive.css-->
        <link rel="stylesheet" href="{% static '/css/responsive.css' %}">

		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
        
        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		
        <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    </head>
	
	<body>
		
		<header id="header-top" class="header-top">
			<!-- <ul>
				<li>
					<div class="header-top-left">
						<ul>
							<li class="select-opt">
								<select name="language" id="language">
									<option value="default">EN</option>
									<option value="Bangla">BN</option>
									<option value="Arabic">AB</option>
								</select>
							</li>
							<li class="select-opt">
								<select name="currency" id="currency">
									<option value="usd">USD</option>
									<option value="euro">Euro</option>
									<option value="bdt">BDT</option>
								</select>
							</li>
							<li class="select-opt">
								<a href="#"><span class="lnr lnr-magnifier"></span></a>
							</li>
						</ul>
					</div>
				</li>
				<li class="head-responsive-right pull-right">
					<div class="header-top-right">
						<ul>
							<li class="header-top-contact">
								+1 222 777 6565
							</li>
							<li class="header-top-contact">
								<a href="#">sign in</a>
							</li>
							<li class="header-top-contact">
								<a href="#">register</a>
							</li>
						</ul>
					</div>
				</li>
			</ul> -->
					
		</header><!--/.header-top-->
		<!--header-top end -->

		<!-- top-area Start -->
		<section class="top-area">
			<div class="header-area">
				<!-- Start Navigation -->
			    <nav class="navbar navbar-default bootsnav  navbar-sticky navbar-scrollspy"  data-minus-value-desktop="70" data-minus-value-mobile="55" data-speed="1000">

			        <div class="container">

			            <!-- Start Header Navigation -->
			            <div class="navbar-header">
			                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-menu">
			                    <i class="fa fa-bars"></i>
			                </button>
			                <a class="navbar-brand" href=" ">Geo<span>Stats</span></a>

			            </div><!--/.navbar-header-->
			            <!-- End Header Navigation -->

			            <!-- Collect the nav links, forms, and other content for toggling -->
			            <div class="collapse navbar-collapse menu-ui-design" id="navbar-menu">
			                <ul class="nav navbar-nav navbar-right" data-in="fadeInDown" data-out="fadeOutUp">
			                    <li class=" scroll active"><a href="#home">home</a></li>
			                    <li class="scroll"><a href="#works">TOP 10</a></li>
			                    <li class="scroll"><a href="#explore">Explore Map</a></li>
			                    
			                </ul><!--/.nav -->
			            </div><!-- /.navbar-collapse -->
			        </div><!--/.container-->
			    </nav><!--/nav-->
			    <!-- End Navigation -->
			</div><!--/.header-area-->
		    <div class="clearfix"></div>

		</section><!-- /.top-area-->
		<!-- top-area End -->

		<!--welcome-hero start -->
		<section id="home" class="welcome-hero">
			<div class="container">
				<div class="welcome-hero-txt">
					<h2>best place to find and explore <br> that all you need </h2>
					<p>
						Uncover Air Quality and Socio-Economic Insights!
					</p>
				</div>
				<div class="welcome-hero-serch-box">
					<div class="welcome-hero-form">
						<!-- <div class="single-welcome-hero-form">
							<h3>what?</h3>
							<form action="index.html">
								<input type="text" placeholder="Ex: palce, resturent, food, automobile" />
							</form>
							<div class="welcome-hero-form-icon">
								<i class="flaticon-list-with-dots"></i>
							</div>
						</div> -->
						<div class="single-welcome-hero-form" style = "width : 1200px; height : 70px; ">
							<h3>location</h3>
							<form id="citySearchForm" method="GET" >
								<input type="text" id="searchInput" name="query" placeholder="Ex: london, newyork, rome" />
							</form>
							<!-- <div class="welcome-hero-form-icon">
								
							</div> -->
						</div>
					</div>
					<div class="welcome-hero-serch" id="searchResults">
						<button type = "submit" class="welcome-hero-btn">
							 search  <i data-feather="search"></i> 
						</button>
					</div>
				
				</div>
			
			</div>
				<div id="searchResultsList" class="container mt-4" style = "width : 800px; height : 70px;">
					<div class="row">
						<div class="col-sm-4 offset-md-4">
							<ul class="list-group">
								{% for city in cities %}
								<li class="list-group-item" >
									{{ city.country }}, {{ city.city }}, {{ city.name }}
								</li>
								{% endfor %}
							</ul>
						</div>
					</div>
				</div>

		</section><!--/.welcome-hero-->
		<!--welcome-hero end -->

		<!--list-topics start -->
		<!-- <section id="list-topics" class="list-topics">
			<div class="container">
				<div class="list-topics-content">
					<ul>
						<li>
							<div class="single-list-topics-content">
								<div class="single-list-topics-icon">
									<i class="flaticon-restaurant"></i>
								</div>
								<h2><a href="#">resturent</a></h2>
								<p>150 listings</p>
							</div>
						</li> -->
						<!-- <li>
							<div class="single-list-topics-content">
								<div class="single-list-topics-icon">
									<i class="flaticon-travel"></i>
								</div>
								<h2><a href="#">destination</a></h2>
								<p>214 listings</p>
							</div>
						</li>
						<li>
							<div class="single-list-topics-content">
								<div class="single-list-topics-icon">
									<i class="flaticon-building"></i>
								</div>
								<h2><a href="#">hotels</a></h2>
								<p>185 listings</p>
							</div>
						</li>
						<li>
							<div class="single-list-topics-content">
								<div class="single-list-topics-icon">
									<i class="flaticon-pills"></i>
								</div>
								<h2><a href="#">healthcaree</a></h2>
								<p>200 listings</p>
							</div>
						</li>
						<li>
							<div class="single-list-topics-content">
								<div class="single-list-topics-icon">
									<i class="flaticon-transport"></i>
								</div>
								<h2><a href="#">automotion</a></h2>
								<p>120 listings</p>
							</div>
						</li>
						<li>
							<div class="single-list-topics-content">
								<div class="single-list-topics-icon">
									<i class="flaticon-restaurant"></i>
								</div>
								<h2><a href="#">resturent</a></h2>
								<p>150 listings</p>
							</div>
						</li>
						<li>
							<div class="single-list-topics-content">
								<div class="single-list-topics-icon">
									<i class="flaticon-restaurant"></i>
								</div>
								<h2><a href="#">resturent</a></h2>
								<p>150 listings</p>
							</div>
						</li>
						<li>
							<div class="single-list-topics-content">
								<div class="single-list-topics-icon">
									<i class="flaticon-restaurant"></i>
								</div>
								<h2><a href="#">resturent</a></h2>
								<p>150 listings</p>
							</div>
						</li>
						<li>
							<div class="single-list-topics-content">
								<div class="single-list-topics-icon">
									<i class="flaticon-restaurant"></i>
								</div>
								<h2><a href="#">resturent</a></h2>
								<p>150 listings</p>
							</div>
						</li>
						<li>
							<div class="single-list-topics-content">
								<div class="single-list-topics-icon">
									<i class="flaticon-restaurant"></i>
								</div>
								<h2><a href="#">resturent</a></h2>
								<p>150 listings</p>
							</div>
						</li> 
					</ul>
				</div>
			</div>

		</section>  -->
		<!--list-topics end-->

		<!--works start -->
		<section id="works" class="works">
			<div class="container">
				<div class="section-header">
					<h2>Top 10 Polluted Cities</h2>
				
				</div><!--/.section-header-->
				<div class="works-content">
					<div class="list-topics-content">
						<ul>
							<!-- <li>
								<div class="single-list-topics-content">
									<div class="single-list-topics-icon">
										<i class="flaticon-restaurant"></i>
									</div>
									<h2><a href="#">resturent</a></h2>
									<p>150 listings</p>
								</div>
							</li>
							<li>
								<div class="single-list-topics-content">
									<div class="single-list-topics-icon">
										<i class="flaticon-travel"></i>
									</div>
									<h2><a href="#">destination</a></h2>
									<p>214 listings</p>
								</div>
							</li>
							<li>
								<div class="single-list-topics-content">
									<div class="single-list-topics-icon">
										<i class="flaticon-building"></i>
									</div>
									<h2><a href="#">hotels</a></h2>
									<p>185 listings</p>
								</div>
							</li>
							<li>
								<div class="single-list-topics-content">
									<div class="single-list-topics-icon">
										<i class="flaticon-pills"></i>
									</div>
									<h2><a href="#">healthcaree</a></h2>
									<p>200 listings</p>
								</div>
							</li>
							<li>
								<div class="single-list-topics-content">
									<div class="single-list-topics-icon">
										<i class="flaticon-transport"></i>
									</div>
									<h2><a href="#">automotion</a></h2>
									<p>120 listings</p>
								</div>
							</li>
							<li>
								<div class="single-list-topics-content">
									<div class="single-list-topics-icon">
										<i class="flaticon-restaurant"></i>
									</div>
									<h2><a href="#">resturent</a></h2>
									<p>150 listings</p>
								</div>
							</li>
							<li>
								<div class="single-list-topics-content">
									<div class="single-list-topics-icon">
										<i class="flaticon-restaurant"></i>
									</div>
									<h2><a href="#">resturent</a></h2>
									<p>150 listings</p>
								</div>
							</li>
							<li>
								<div class="single-list-topics-content">
									<div class="single-list-topics-icon">
										<i class="flaticon-restaurant"></i>
									</div>
									<h2><a href="#">resturent</a></h2>
									<p>150 listings</p>
								</div>
							</li>
							<li>
								<div class="single-list-topics-content">
									<div class="single-list-topics-icon">
										<i class="flaticon-restaurant"></i>
									</div>
									<h2><a href="#">resturent</a></h2>
									<p>150 listings</p>
								</div>
							</li>
							<li>
								<div class="single-list-topics-content">
									<div class="single-list-topics-icon">
										<i class="flaticon-restaurant"></i>
									</div>
									<h2><a href="#">resturent</a></h2>
									<p>150 listings</p>
								</div>
							</li> -->
						</ul>
					</div>
				</div>
			</div><!--/.container-->
		
		</section><!--/.works-->

		<!--works end -->

		<section id="works" class="works">
			<div class="container">
				<div class="section-header">
					<h2>Top 10 Cleanest Cities</h2>
				
				</div><!--/.section-header-->
				<div class="works-content">
					<div class="list-topics-content02">
						<ul>
							
						</ul>
					</div>
				</div>
			</div><!--/.container-->
		
		</section>

		<!--explore start -->
		<section id="explore" class="explore">
			<div class="container">
				<div class="section-header">
					<h2>Explore</h2>
					<p>Know Air pollution the invisible villain around the world!</p>
				</div>
				<div class="explore-content">
					<div class="row">
						<div class="col-md-12 col-sm-6" >

							<div class="single-explore-item">
								<div  id = 'map'>
									
									
								</div>
								
							</div>
						</div>
					
									
											</div>
										</div>
			</div>
									
		</section> 
		<!--explore end -->

	
		

		<!--subscription strat -->
		<section id="contact"  class="subscription">
			<div class="container">
				<div class="subscribe-title text-center">
					<h2>
						do you want to add your business listing with us?
					</h2>
					<p>
						Listrace offer you to list your business with us and we very much able to promote your Business.
					</p>
				</div>
				<div class="row">
					<div class="col-sm-12">
						<div class="subscription-input-group">
							<form action="#">
								<input type="email" class="subscription-input-form" placeholder="Enter your email here">
								<button class="appsLand-btn subscribe-btn" onclick="window.location.href='#'">
									creat account
								</button>
							</form>
						</div>
					</div>	
				</div>
			</div>

		</section><!--/subscription-->	
		<!--subscription end -->

		<!--footer start-->
		<footer id="footer"  class="footer">
			<div class="container">

				<div class="hm-footer-copyright">
					<div class="row">
						<div class="col-sm-5">
							<p>
								&copy;copyright. designed and developed by UAP</a>
							</p><!--/p-->
						</div>
						<div class="col-sm-7">
							<div class="footer-social">
								
								<a href="#"><i class="fa fa-facebook"></i></a>	
								<a href="#"><i class="fa fa-twitter"></i></a>
								<a href="#"><i class="fa fa-linkedin"></i></a>
								<a href="#"><i class="fa fa-google-plus"></i></a>
							</div>
						</div>
					</div>
					
				</div><!--/.hm-footer-copyright-->
			</div><!--/.container-->

			<div id="scroll-Top">
				<div class="return-to-top">
					<i class="fa fa-angle-up " id="scroll-top" data-toggle="tooltip" data-placement="top" title="" data-original-title="Back to Top" aria-hidden="true"></i>
				</div>
				
			</div><!--/.scroll-Top-->
			
        </footer><!--/.footer-->
		<!--footer end-->
		
		<!-- Include all js compiled plugins (below), or include individual files as needed -->

		<script src="{% static '/js/jquery.js' %}"></script>
        
        <!--modernizr.min.js-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
		
		<!--bootstrap.min.js-->
        <script src="{% static '/js/bootstrap.min.js' %}"></script>
		
		<!-- bootsnav js -->
		<script src="{% static '/js/bootsnav.js' %}"></script>

        <!--feather.min.js-->
        <script  src="{% static '/js/feather.min.js' %}"></script>

        <!-- counter js -->
		<script src="{% static '/js/jquery.counterup.min.js' %}"></script>
		<script src="{% static '/js/waypoints.min.js' %}"></script>

        <!--slick.min.js-->
        <script src="{% static '/js/slick.min.js' %}"></script>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
		     
        <!--Custom JS-->
        <script src="{% static '/js/custom.js' %}"></script>

		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
function getColorByScore(score) {
    if (score <= 50) {
        return "green";
    } else if (score <= 100) {
        return "yellow";
    } else if (score <= 150) {
        return "orange";
    } else if (score <= 200) {
        return "red";
    } else if (score <= 300) {
        return "purple";
    }else {
        return "maroon";
    }
}



const pollutedCitiesContainer = document.querySelector('.list-topics-content ul');
const apiUrl = `http://127.0.0.1:8000/api/ranking/?top=10`

fetch(apiUrl)
  .then(response => response.json())
  .then(jsonData => {
    const pollutedCities = jsonData.polluted;

    pollutedCities.forEach(item => {
      const listItem = document.createElement("li");
      listItem.innerHTML = `
	  <div class="single-list-topics-content" style="background-color: ${getColorByScore(item.score)};">
    <div class="single-list-topics-icon">
        <img src="${item.flag}" alt="Flag">
    </div>
    <h6>${item.city}</h6>
    <h6>Score: ${item.score}</h6>
</div>

      `;
      pollutedCitiesContainer.appendChild(listItem);
    });
  })
  .catch(error => {
    console.error("Error fetching data:", error);
  });

const cleanestCitiesContainer = document.querySelector('.list-topics-content02 ul');
const topUrl = `http://127.0.0.1:8000/api/ranking/?top=10`

fetch(topUrl)
  .then(response => response.json())
  .then(jsonData => {
    const cleanCities = jsonData.cleanest;

    cleanCities.forEach(item => {
      const listItem = document.createElement("li");
      listItem.innerHTML = `
        <div class="single-list-topics-content02"  style="background-color: ${getColorByScore(item.score)};">
          <div class="single-list-topics-icon02">
            <img src="${item.flag}" alt="Flag">
          </div>
          <h6>${item.city}</h6>
          <h6>Score: ${item.score}</h6>
        </div>
      `;
      cleanestCitiesContainer.appendChild(listItem);
    });
  })
  .catch(error => {
    console.error("Error fetching data:", error);
  });



        $(document).ready(function () {
            $('#citySearchForm').on('submit', function (e) {
                e.preventDefault();
                const query = $('#searchInput').val();
				

                fetch(`http://127.0.0.1:8000/api/search/?query=${query}`)
                    .then(response => response.json())
                    .then(data => {
                        console.log(data);
                        displaySearchResults(data);
                    });
            });

            // Add event listener to input element
            const inputBox = document.getElementById("searchInput");
            inputBox.addEventListener("input", function() {
                const inputValue = inputBox.value.trim();

                // Clear the search results
                // document.getElementById("searchResults").innerHTML = "";

                if (inputValue === "") {
                    document.getElementById("searchResultsList").innerHTML = "";
                    return;
                }

                // Implement your dynamic search logic here
                // For example, you can make an API request to fetch and display search results
                fetch(`http://127.0.0.1:8000/api/search/?query=${inputValue}`)
                    .then(response => response.json())
                    .then(data => {
                        const searchResults = document.getElementById("searchResultsList");

                        // Clear previous search results
                        searchResults.innerHTML = "";

                        // Display new search results
                        data.slice(0, 5).forEach(result => {
                            const cityText = result.city !== null ? `${result.city}, ` : '';
                            const nameText = result.name !== null ? `${result.name}, ` : '';

							console.log(result)
                            // searchResults.innerHTML += `<a href=""><li class="list-group-item">${result.country},${cityText},${nameText}</li></a>`;
							searchResults.innerHTML += `<a href="http://127.0.0.1:8000/info/${result.location_id}"><li class="list-group-item">${result.country},${cityText},${nameText}</li></a>`;

                        });
                    });
            });

            function displaySearchResults(results) {
                const searchResults = document.getElementById("searchResultsList");
                searchResults.innerHTML = "";

                if (results.length === 0) {
                    searchResults.innerHTML = '<li class="list-group-item">No results found.</li>';
                } else {
                    results.slice(0,5).forEach(result => {
                        const cityText = result.city !== null ? `${result.city}, ` : '';
                        const nameText = result.name !== null ? `${result.name}, ` : '';

                        searchResults.innerHTML += `<li class="list-group-item">${result.country},${cityText},${nameText}</li>`;

                    });
                }
            }
        });
    </script>

    <!-- Include Bootstrap JS and Popper.js -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="{% static '/js/main.js' %}"></script>
        
    </body>
	
</html>